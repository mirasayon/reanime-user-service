# scripts.yaml for reanime.art Prisma + PostgreSQL workflows
# Usage: yarn run-script <script>  (or any runner you choose)

env_files:
    development: .env.development
    test: .env.test
    production: .env.production

scripts:
    migrate:
        dev:
            description: "Create & apply migrations on the development database"
            command: "dotenv -e .env.development -- prisma migrate dev --name default-migration-name"
        reset:
            description: "Reset the development database & reapply all migrations"
            command: "dotenv -e .env.development -- prisma migrate reset --force"
        deploy:
            description: "Deploy all pending migrations to the production database"
            command: "dotenv -e .env.production -- prisma migrate deploy"

    generate:
        dev:
            description: "Generate Prisma client for development"
            command: "dotenv -e .env.development -- prisma generate"
        test:
            description: "Generate Prisma client for test"
            command: "dotenv -e .env.test -- prisma generate"
        prod:
            description: "Generate Prisma client for production"
            command: "dotenv -e .env.production -- prisma generate"

    seed:
        dev:
            description: "Seed the development database"
            command: "dotenv -e .env.development -- node --loader ts-node/esm prisma/seed.ts"
        test:
            description: "Seed the test database"
            command: "dotenv -e .env.test -- node --loader ts-node/esm prisma/seed.ts"
        prod:
            description: "Seed the production database (use with caution!)"
            command: "dotenv -e .env.production -- node --loader ts-node/esm prisma/seed.ts"

    test:
        run:
            description: "Run tests against the test database"
            command: "dotenv -e .env.test -- npm test"
